{% extends "base2.html" %}
{% block title %}Project Review{% endblock %}

<body class="font-sans text-black">
    {% block content %}
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Animate.css -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/static/CSS/review.css">



    <div class="max-w-7xl mx-auto px-1 py-2">

        <button id="refreshBtn" style="    position: relative;
    left: 1200px;"
            class="px-5 py-2 rounded-xl bg-gradient-to-r from-sky-400 via-purple-400 to-sky-500 text-white text-sm shadow-md transition animate__animated animate__pulse animate__infinite glowy">
            üîÑ Refresh
        </button>


        <!-- Grid container (3 per row) -->
        <div id="cardScroller"
            class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-h-[78vh] overflow-y-auto no-scrollbar pr-1">
            {% for d in data %}
            <div id="card-{{ d._id }}"
                class="rounded-2xl border border-sky-200 bg-white shadow-xl overflow-hidden transition transform hover:scale-[1.01] hover:shadow-2xl animate__animated animate__fadeInUp floaty glowy flex flex-col">

                <!-- Shimmer ribbon -->
                <div class="h-1 shimmer"></div>

                <!-- Top: image left + info right -->
                <div class="flex flex-col md:flex-row p-5 gap-4 tilty">
                    <!-- IMAGE -->
                    <div class="w-full md:w-1/2">
                        <div
                            class="relative w-full rounded-xl overflow-hidden border border-sky-200 bg-sky-50 shadow-md">
                            {% if d.image_is_url %}
                            <img src="{{ d.image_value }}" alt="Preview"
                                class="w-full h-44 object-cover animate__animated animate__zoomIn" loading="lazy" />
                            {% else %}
                            <img src="data:image/png;base64,{{ d.image_value or placeholder }}" alt="Preview"
                                class="w-full h-44 object-cover animate__animated animate__zoomIn" loading="lazy" />
                            {% endif %}
                            <div
                                class="absolute top-2 right-2 px-2 py-1 rounded-full bg-white/80 text-[11px] border border-sky-200 shadow-sm">
                                {{ (d.status or 'pending') | capitalize }}
                            </div>
                        </div>
                    </div>

                    <!-- INFO -->
                    <div class="flex-1 flex flex-col justify-between">
                        <div>
                            <h2 class="text-lg font-bold text-sky-800 animate__animated animate__fadeInLeft">{{
                                d.display_name }}</h2>
                            <span
                                class="text-xs inline-block mt-1 px-2 py-1 rounded-md bg-gradient-to-r from-sky-100 to-purple-100 border border-sky-200">
                                ELA: {{ '%.2f'|format(d.ela_score) if d.ela_score is not none else '‚Äî' }}
                            </span>
                        </div>

                        <div class="mt-3 text-sm">
                            <div
                                class="inline-flex items-center gap-2 px-3 py-1 rounded-lg bg-gradient-to-r from-sky-50 to-white border border-sky-200 shadow-inner">
                                <span>üïí</span>
                                <span>{{ d.display_time }}</span>
                            </div>
                        </div>

                        <div class="mt-3 flex flex-wrap gap-2 text-sm">
                            {% if d.display_lat is not none and d.display_lon is not none %}
                            <a target="_blank" href="https://maps.google.com/?q={{ d.display_lat }},{{ d.display_lon }}"
                                class="px-3 py-1 rounded-lg bg-gradient-to-r from-sky-50 to-green-50 border border-sky-200 hover:from-sky-100 hover:to-green-100 transition shadow-sm">
                                üìç {{ '%.5f'|format(d.display_lat) }}, {{ '%.5f'|format(d.display_lon) }}
                            </a>
                            {% else %}
                            <span class="px-3 py-1 rounded-lg bg-sky-50 border border-sky-200">üìç Coordinates:
                                N/A</span>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Bottom: additional details -->
                <div class="px-5 pb-5 space-y-3">
                    <div
                        class="rounded-xl bg-gradient-to-r from-sky-50 to-purple-50 border border-sky-200 p-3 animate__animated animate__fadeIn">
                        <p class="text-[11px] uppercase tracking-wide text-gray-600"> Metadata unique id </p>
                        <p class="text-sm font-medium">{{ d._id or '‚Äî' }}</p>
                    </div>

                    <div
                        class="rounded-xl bg-gradient-to-r from-sky-50 to-purple-50 border border-sky-200 p-3 animate__animated animate__fadeIn">
                        <p class="text-[11px] uppercase tracking-wide text-gray-600">Scientific Name</p>
                        <p class="text-sm font-medium">{{ d.plant.scientific_name or '‚Äî' }}</p>
                    </div>

                    <div
                        class="rounded-xl bg-gradient-to-r from-green-50 to-sky-50 border border-sky-200 p-3 animate__animated animate__fadeIn animate__delay-1s">
                        <p class="text-[11px] uppercase tracking-wide text-gray-600">Common Names</p>
                        {% if d.plant.common_names %}
                        <div class="flex flex-wrap gap-2">
                            {% for n in d.plant.common_names %}
                            <span class="px-2 py-1 rounded-md bg-white border border-sky-200 text-xs shadow-sm">{{ n
                                }}</span>
                            {% endfor %}
                        </div>
                        {% else %}
                        <p class="text-sm">‚Äî</p>
                        {% endif %}
                    </div>

                    <div
                        class="rounded-xl bg-gradient-to-r from-yellow-50 to-sky-50 border border-sky-200 p-3 animate__animated animate__fadeIn animate__delay-2s">
                        <p class="text-[11px] uppercase tracking-wide text-gray-600">Taxonomy</p>
                        {% set tx = d.plant.taxonomy or {} %}
                        <div class="text-sm leading-6">
                            <div><span class="font-semibold">Kingdom:</span> {{ tx.kingdom or '‚Äî' }}</div>
                            <div><span class="font-semibold">Phylum:</span> {{ tx.phylum or '‚Äî' }}</div>
                            <div><span class="font-semibold">Class:</span> {{ tx.class or '‚Äî' }}</div>
                            <div><span class="font-semibold">Order:</span> {{ tx.order or '‚Äî' }}</div>
                            <div><span class="font-semibold">Family:</span> {{ tx.family or '‚Äî' }}</div>
                            <div><span class="font-semibold">Genus:</span> {{ tx.genus or '‚Äî' }}</div>
                        </div>
                    </div>


                </div>

                <!-- Actions -->
                <div class="flex gap-3 px-5 pb-5">
                    <button {% if d.status=='accepted' %}disabled{% endif %} onclick="act('{{ d._id }}','accept')"
                        class="px-5 py-2 rounded-xl bg-gradient-to-r from-green-400 to-green-600 hover:from-green-500 hover:to-green-700 text-white text-sm shadow-md transition animate__animated animate__bounceIn">
                        ‚úÖ Accept
                    </button>
                    <button onclick="act('{{ d._id }}','reject')"
                        class="px-5 py-2 rounded-xl bg-gradient-to-r from-red-400 to-red-600 hover:from-red-500 hover:to-red-700 text-white text-sm shadow-md transition animate__animated animate__bounceIn">
                        ‚ùå Reject
                    </button>
                </div>
            </div>
            {% endfor %}

            {% if data|length == 0 %}
            <div class="col-span-3 text-center py-20 text-gray-600 animate__animated animate__fadeIn">No records to
                review.</div>
            {% endif %}
        </div>
    </div>

    <script src="/static/JS/review.js"></script>
    {% endblock %}
</body>